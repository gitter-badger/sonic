!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.Sonic=e()}}(function(){return function e(t,n,r){function u(s,a){if(!n[s]){if(!t[s]){var l="function"==typeof require&&require;if(!a&&l)return l(s,!0);if(i)return i(s,!0);var o=new Error("Cannot find module '"+s+"'");throw o.code="MODULE_NOT_FOUND",o}var c=n[s]={exports:{}};t[s][0].call(c.exports,function(e){var n=t[s][1][e];return u(n?n:e)},c,c.exports,e,t,n,r)}return n[s].exports}for(var i="function"==typeof require&&require,s=0;s<r.length;s++)u(r[s]);return u}({1:[function(e,t,n){"use strict";Object.defineProperties(n,{"default":{get:function(){return o}},__esModule:{value:!0}});var r,u,i=(r=e("./observable"),r&&r.__esModule&&r||{"default":r}).Subject,s=(u=e("./mutable_list"),u&&u.__esModule&&u||{"default":u}).MutableList,a=function(){var e=void 0!==arguments[0]?arguments[0]:[],t=this;$traceurRuntime.superConstructor(l).call(this),this.has=function(e){return null!=e&&e>-1&&e<t._array.length},this.get=function(e){return t.has(e)?t._array[e]:void 0},this.prev=function(e){return null==e&&t._array.length?t._array.length-1:t._array.length>0&&null!=e&&t.has(e)&&t.has(e-1)?e-1:null},this.next=function(e){return null==e&&t._array.length?0:t._array.length>0&&null!=e&&t.has(e)&&t.has(e+1)?e+1:null},this.set=function(e,n){return t.has(e)?(t._array[e]=n,e):null},this.splice=function(e,n){for(var r,u=[],i=2;i<arguments.length;i++)u[i-2]=arguments[i];if(null==e)e=-1;else if(!t.has(e))return;if(null==n)n=t._array.length;else if(!t.has(n))return;(r=t._array).splice.apply(r,$traceurRuntime.spread([e+1,n-(e+1)],u)),t._invalidate(e,null)},this.observe=function(e){return t._subject.observe(e)},this._invalidate=function(e,n){t.has(e)||(e=null),t.has(n)||(n=null),t._subject.notify(function(t){t.onInvalidate(e,n)})},this._subject=new i,this._array=e},l=a;$traceurRuntime.createClass(a,{},{},s);var o=a},{"./mutable_list":10,"./observable":11}],2:[function(e,t,n){"use strict";Object.defineProperties(n,{AsyncList:{get:function(){return r}},"default":{get:function(){return i}},__esModule:{value:!0}});var r=function(e,t){var n=this;this.has=function(e){return new Promise(function(t,r){n._scheduler(function(){Promise.resolve(n._list.has(e)).then(t)["catch"](r)})})},this.get=function(e){return new Promise(function(t,r){n.has(e).then(function(u){return u?t(n._list.get(e)):r()})["catch"](r)})},this.prev=function(e){return new Promise(function(t,r){n._scheduler(function(){Promise.resolve(n._list.prev(e)).then(function(e){return null!=e?t(e):r()})["catch"](r)})})},this.next=function(e){return new Promise(function(t,r){n._scheduler(function(){Promise.resolve(n._list.next(e)).then(function(e){return null!=e?t(e):r()})["catch"](r)})})},this._list=e,this._scheduler=t||window.setTimeout},u=r;$traceurRuntime.createClass(r,{},{create:function(e){return new u(e)}});var i=r},{}],3:[function(e,t,n){"use strict";Object.defineProperties(n,{Cache:{get:function(){return r}},"default":{get:function(){return u}},__esModule:{value:!0}});var r=function(e){var t=this;this.has=function(e){return e in t._byKey||t._list.has(e)},this.get=function(e){return e in t._byKey?t._byKey[e]:t._list.has(e)?t._byKey[e]=t._list.get(e):void 0},this.prev=function(e){if(e in t._prev)return t._prev[e];var n=t._list.prev(e);return null==n&&(n=null),t._prev[e]=n,t._next[n]=e,n},this.next=function(){var e=void 0!==arguments[0]?arguments[0]:null;if(e in t._next)return t._next[e];var n=t._list.next(e);return null==n&&(n=null),t._next[e]=n,t._prev[n]=e,n},this._byKey=Object.create(null),this._next=Object.create(null),this._prev=Object.create(null),this._list=e};$traceurRuntime.createClass(r,{},{});var u=r},{}],4:[function(e,t,n){"use strict";function r(e){return f.isMutableList(e)?f.create(e):c.isObservableList(e)?c.create(e):o.isList(e)?o.create(e):Array.isArray(e)?new d(e):v.create(e)}Object.defineProperties(n,{"default":{get:function(){return h}},__esModule:{value:!0}});var u,i,s,a,l,o=(u=e("./list"),u&&u.__esModule&&u||{"default":u}).List,c=(i=e("./observable_list"),i&&i.__esModule&&i||{"default":i}).ObservableList,f=(s=e("./mutable_list"),s&&s.__esModule&&s||{"default":s}).MutableList,v=(a=e("./unit"),a&&a.__esModule&&a||{"default":a})["default"],d=(l=e("./array_list"),l&&l.__esModule&&l||{"default":l})["default"],h=r},{"./array_list":1,"./list":9,"./mutable_list":10,"./observable_list":15,"./unit":17}],5:[function(e,t,n){"use strict";Object.defineProperties(n,{Index:{get:function(){return r}},"default":{get:function(){return u}},__esModule:{value:!0}});var r=function(e){var t=this;this.has=function(e){if(e>=0&&e<t._byIndex.length)return!0;for(var n,r=t._byIndex.length-1;r!=e;){if(n=t._list.next(t._byIndex[r]),null==n)return!1;t._byIndex[++r]=n}return!0},this.get=function(e){return t.has(e)?t._list.get(t._byIndex[e]):void 0},this.prev=function(e){return t.has(e-1)?e-1:null==e&&t._byIndex.length?t._byIndex.length-1:null},this.next=function(){var e=void 0!==arguments[0]?arguments[0]:-1;return t.has(e+1)?e+1:null},this._byIndex=[],this._list=e};$traceurRuntime.createClass(r,{},{});var u=r},{}],6:[function(e,t,n){"use strict";Object.defineProperties(n,{"default":{get:function(){return u}},__esModule:{value:!0}});var r;!function(e){function t(e){return e.toString()}function n(){return r++}var r=0;e.key=t,e.create=n}(r||(r={}));var u=r},{}],7:[function(e,t,n){"use strict";Object.defineProperties(n,{KeyBy:{get:function(){return r}},"default":{get:function(){return u}},__esModule:{value:!0}});var r=function(e,t){var n=this;this.has=function(e){if(e in n._sourceKeyByKey)return!0;for(var t=null;null!=(t=n.next(t));)if(t==e)return!0;return!1},this.get=function(e){return n.has(e)?n._list.get(n._sourceKeyByKey[e]):void 0},this.prev=function(e){return n.has(e)||null==e?n._keyBySourceKey[n._list.prev(n._sourceKeyByKey[e])]:void 0},this.next=function(){var e,t,r=void 0!==arguments[0]?arguments[0]:null;e=r in n._sourceKeyByKey?n._sourceKeyByKey[r]:null;for(;null!=r&&!(r in n._sourceKeyByKey);)if(e=n._list.next(e),!(e in n._keyBySourceKey)){if(null==e)return null;if(t=n._keyFn(n._list.get(e),e),n._keyBySourceKey[e]=t,n._sourceKeyByKey[t]=e,t==r)break}return e=n._list.next(e),null==e?null:(t=n._keyFn(n._list.get(e),e),n._keyBySourceKey[e]=t,n._sourceKeyByKey[t]=e,t)},this._list=e,this._keyFn=t,this._sourceKeyByKey=Object.create(null),this._keyBySourceKey=Object.create(null)};$traceurRuntime.createClass(r,{},{});var u=r},{}],8:[function(e,t,n){"use strict";Object.defineProperties(n,{"default":{get:function(){return f}},__esModule:{value:!0}});var r,u,i,s=(r=e("./key"),r&&r.__esModule&&r||{"default":r})["default"],a=(u=e("./observable"),u&&u.__esModule&&u||{"default":u}).Subject,l=(i=e("./mutable_list"),i&&i.__esModule&&i||{"default":i}).MutableList,o=function(e,t){var n,r=this;$traceurRuntime.superConstructor(c).call(this),this._keyFn=s.create,this.has=function(e){return e in r._byKey},this.get=function(e){return r._byKey[e]},this.prev=function(){var e=void 0!==arguments[0]?arguments[0]:null,t=r._prev[e];return null==t?null:t},this.next=function(){var e=void 0!==arguments[0]?arguments[0]:null,t=r._next[e];return null==t?null:t},this.set=function(e,t){return r.has(e)?(r._byKey[e]=t,r._invalidate(r._prev[e],r._next[e]),e):null},this.splice=function(){for(var e=void 0!==arguments[0]?arguments[0]:null,t=void 0!==arguments[1]?arguments[1]:null,n=[],u=2;u<arguments.length;u++)n[u-2]=arguments[u];var i,s;for(i=e;null!=(i=r._next[i])&&(delete r._next[r._prev[i]],delete r._prev[i],i!=t);)delete r._byKey[i];for(i=t;null!=(i=r._prev[i])&&(delete r._prev[r._next[i]],delete r._next[i],i!=e);)delete r._byKey[i];for(var a,l=e,o=n[$traceurRuntime.toProperty(Symbol.iterator)]();!(a=o.next()).done;)s=a.value,i=r._keyFn(s),r._byKey[i]=s,r._prev[i]=l,r._next[l]=i,l=i;r._prev[t]=l,r._next[l]=t,r._invalidate(e,t)},this.observe=function(e){return r._subject.observe(e)},this._invalidate=function(e,t){r.has(e)||(e=null),r.has(t)||(t=null),r._subject.notify(function(n){n.onInvalidate(e,t)})},t&&(this._keyFn=t),this._subject=new a,this._byKey=Object.create(null),this._prev=Object.create(null),this._next=Object.create(null),this._prev[null]=null,this._next[null]=null,(n=this).splice.apply(n,$traceurRuntime.spread([null,null],e))},c=o;$traceurRuntime.createClass(o,{},{},l);var f=o},{"./key":6,"./mutable_list":10,"./observable":11}],9:[function(e,t,n){"use strict";Object.defineProperties(n,{List:{get:function(){return _}},"default":{get:function(){return y}},__esModule:{value:!0}});var r,u,i,s,a,l=(r=e("./tree"),r&&r.__esModule&&r||{"default":r}),o=l.Tree,c=l.Path,f=(u=e("./cache"),u&&u.__esModule&&u||{"default":u})["default"],v=(i=e("./index"),i&&i.__esModule&&i||{"default":i})["default"],d=(s=e("./key_by"),s&&s.__esModule&&s||{"default":s})["default"],h=(a=e("./async_list"),a&&a.__esModule&&a||{"default":a}).AsyncList,_=function(e){var t=this;this.has=function(e){throw new Error("Not implemented")},this.get=function(e){throw new Error("Not implemented")},this.prev=function(e){throw new Error("Not implemented")},this.next=function(e){throw new Error("Not implemented")},this.first=function(){return b.first(t)},this.last=function(){return b.last(t)},this.forEach=function(e){return b.forEach(t,e)},this.reduce=function(e,n){return b.reduce(t,e)},this.toArray=function(){return b.toArray(t)},this.findKey=function(e){return b.findKey(t,e)},this.find=function(e){return b.find(t,e)},this.keyOf=function(e){return b.keyOf(t,e)},this.indexOf=function(e){return b.indexOf(t,e)},this.keyAt=function(e){return b.keyAt(t,e)},this.at=function(e){return b.at(t,e)},this.every=function(e){return b.every(t,e)},this.some=function(e){return b.some(t,e)},this.contains=function(e){return b.contains(t,e)},this.reverse=function(){return b.create(b.reverse(t))},this.map=function(e){return b.create(b.map(t,e))},this.filter=function(e){return b.create(b.filter(t,e))},this.flatten=function(){return b.create(b.flatten(t))},this.flatMap=function(e){return b.create(b.flatMap(t,e))},this.cache=function(){return b.create(b.cache(t))},this.index=function(){return b.create(b.index(t))},this.keyBy=function(e){return b.create(b.keyBy(t,e))},this.zip=function(e,n){return b.create(b.zip(t,e,n))},this.skip=function(e){return b.create(b.skip(t,e))},this.take=function(e){return b.create(b.take(t,e))},this.range=function(e,n){return b.create(b.range(t,e,n))},this.scan=function(e,n){return b.create(b.scan(t,e,n))},null!=e&&(this.has=e.has,this.get=e.get,this.prev=e.prev,this.next=e.next)},b=_;$traceurRuntime.createClass(_,{},{isList:function(e){return!!(null!=e&&e.has&&e.get&&e.prev&&e.next)},create:function(e){return new b({has:e.has,get:e.get,prev:e.prev,next:e.next})},first:function(e){return e.get(e.next())},last:function(e){return e.get(e.prev())},forEach:function(e,t){for(var n;null!=(n=e.next(n));)t(e.get(n),n)},reduce:function(e,t,n){for(var r;null!=(r=e.next(r));)n=t(n,e.get(r),r);return n},toArray:function(e){for(var t,n=0,r=[];null!=(t=e.next(t));)r[n++]=e.get(t);return r},findKey:function(e,t){for(var n;null!=(n=e.next(n));)if(t(e.get(n),n))return n},find:function(e,t){return e.get(b.findKey(e,t))},keyOf:function(e,t){return b.findKey(e,function(e){return e===t})},indexOf:function(e,t){for(var n,r=0;null!=(n=e.next(n));){if(e.get(n)===t)return r;r++}},keyAt:function(e,t){for(var n,r=0;null!=(n=e.next(n));)if(r++==t)return n;return null},at:function(e,t){return e.get(b.keyAt(e,t))},every:function(e,t){for(var n;null!=(n=e.next(n));)if(!t(e.get(n),n))return!1;return!0},some:function(e,t){for(var n;null!=(n=e.next(n));)if(t(e.get(n),n))return!0;return!1},contains:function(e,t){return b.some(e,function(e){return e===t})},reverse:function(e){function t(t){return e.next(t)}function n(t){return e.prev(t)}var r=e,u=r.has,i=r.get;return{has:u,get:i,prev:t,next:n}},map:function(e,t){function n(n){return u(n)?t(e.get(n),n):void 0}var r=e,u=r.has,i=r.prev,s=r.next;return{has:u,get:n,prev:i,next:s}},filter:function(e,t){function n(n){return e.has(n)&&t(e.get(n),n)}function r(t){return n(t)?e.get(t):void 0}function u(t){for(var r=t;null!=(r=e.prev(r));)if(n(r))return r;return null}function i(t){for(var r=t;null!=(r=e.next(r));)if(n(r))return r;return null}return{has:n,get:r,prev:u,next:i}},flatten:function(e){function t(t){var n=c.create(t);return o.has(e,n,1)}function n(t){var n=c.create(t);return o.get(e,n,1)}function r(t){var n=c.create(t);return c.key(o.prev(e,n,1))}function u(t){var n=c.create(t);return c.key(o.next(e,n,1))}return{has:t,get:n,prev:r,next:u}},flatMap:function(e,t){return b.flatten(b.map(e,t))},cache:function(e){return new f(e)},index:function(e){return new v(e)},keyBy:function(e,t){return new d(e,t)},zip:function(e,t,n){function r(n){return e.has(n)&&t.has(n)}function u(u){return r(u)?n(e.get(u),t.get(u)):void 0}function i(n){var r=e.prev(n);return null!=r&&r==t.prev(n)?r:null}function s(n){var r=e.next(n);return null!=r&&r==t.next(n)?r:null}return e=b.index(e),t=b.index(t),{has:r,get:u,prev:i,next:s}},skip:function(e,t){return b.filter(b.index(e),function(e,n){return n>=t})},take:function(e,t){return b.filter(b.index(e),function(e,n){return t>n})},range:function(e,t,n){return b.filter(b.index(e),function(e,r){return r>=t&&n+t>r})},scan:function(e,t,n){function r(r){var i=u.prev(r);return t(null!=i?u.get(i):n,e.get(r))}var u,i=e,s=i.has,a=i.prev,l=i.next;return u=b.cache({has:s,get:r,prev:a,next:l})},async:function(e,t){return new h(e)}});var y=_},{"./async_list":2,"./cache":3,"./index":5,"./key_by":7,"./tree":16}],10:[function(e,t,n){"use strict";Object.defineProperties(n,{MutableList:{get:function(){return i}},"default":{get:function(){return a}},__esModule:{value:!0}});var r,u=(r=e("./observable_list"),r&&r.__esModule&&r||{"default":r}).ObservableList,i=function(e){var t=this;$traceurRuntime.superConstructor(s).call(this,e),this.set=function(e,t){throw new Error("Not implemented")},this.splice=function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];throw new Error("Not implemented")},this.addBefore=function(e,n){return s.addBefore(t,e,n)},this.addAfter=function(e,n){return s.addAfter(t,e,n)},this.push=function(e){return s.push(t,e)},this.unshift=function(e){return s.unshift(t,e)},this["delete"]=function(e){return s["delete"](t,e)},this.deleteBefore=function(e){return s.deleteBefore(t,e)},this.deleteAfter=function(e){return s.deleteAfter(t,e)},this.pop=function(){return s.pop(t)},this.shift=function(){return s.shift(t)},this.remove=function(e){return s.remove(t,e)},null!=e&&(this.set=e.set,this.splice=e.splice)},s=i;$traceurRuntime.createClass(i,{},{isMutableList:function(e){return u.isObservableList(e)&&!!e.set&&!!e.splice},create:function(e){return new s({has:e.has,get:e.get,prev:e.prev,next:e.next,observe:e.observe,set:e.set,splice:e.splice})},addBefore:function(e,t,n){return e.splice(e.prev(t),t,n),e.prev(t)},addAfter:function(e,t,n){return e.splice(t,e.next(t),n),e.next(t)},push:function(e,t){return s.addBefore(e,null,t)},unshift:function(e,t){return s.addAfter(e,null,t)},"delete":function(e,t){if(e.has(t)){var n=e.get(t);return e.splice(e.prev(t),e.next(t)),n}},deleteBefore:function(e,t){return s["delete"](e,e.prev(t))},deleteAfter:function(e,t){return s["delete"](e,e.next(t))},pop:function(e){return s.deleteBefore(e,null)},shift:function(e){return s.deleteAfter(e,null)},remove:function(e,t){var n=s.keyOf(e,t);return null==n?!1:(delete n,!0)}},u);var a=i},{"./observable_list":15}],11:[function(e,t,n){"use strict";Object.defineProperties(n,{Subject:{get:function(){return i}},__esModule:{value:!0}});var r,u=(r=e("./key"),r&&r.__esModule&&r||{"default":r})["default"],i=function(){var e=this;this.observe=function(t){var n=u.create();return e._observers[n]=t,{unsubscribe:function(){delete e._observers[n]}}},this.notify=function(t){for(var n in e._observers)t(e._observers[n])},this._observers=Object.create(null)};$traceurRuntime.createClass(i,{},{})},{"./key":6}],12:[function(e,t,n){"use strict";Object.defineProperties(n,{ObservableCache:{get:function(){return i}},"default":{get:function(){return a}},__esModule:{value:!0}});var r,u=(r=e("./cache"),r&&r.__esModule&&r||{"default":r})["default"],i=function(e){var t=this;$traceurRuntime.superConstructor(s).call(this,e),this.observe=function(e){return t._list.observe(e)},this.onInvalidate=function(e,n){var r;for(r=e;void 0!==(r=t._next[r])&&(delete t._next[t._prev[r]],delete t._prev[r],r!=n);)delete t._byKey[r];for(;void 0!==(r=t._prev[r])&&(delete t._prev[t._next[r]],delete t._next[r],r!=e);)delete t._byKey[r]},e.observe(this)},s=i;$traceurRuntime.createClass(i,{},{},u);var a=i},{"./cache":3}],13:[function(e,t,n){"use strict";Object.defineProperties(n,{ObservableIndex:{get:function(){return a}},"default":{get:function(){return o}},__esModule:{value:!0}});var r,u,i=(r=e("./index"),r&&r.__esModule&&r||{"default":r})["default"],s=(u=e("./observable"),u&&u.__esModule&&u||{"default":u}).Subject,a=function(e){var t=this;$traceurRuntime.superConstructor(l).call(this,e),this.has=function(e){if(e>=0&&e<t._byIndex.length)return!0;for(var n,r=t._byIndex.length-1;r!=e;){if(n=t._list.next(t._byIndex[r]),null==n)return!1;t._byIndex[++r]=n,t._byKey[n]=r}return!0},this.observe=function(e){return t._subject.observe(e)},this.onInvalidate=function(e,n){for(var r=t._byKey[e],u=t._byIndex.length,i=r;++i<u;)delete t._byKey[t._byIndex[i]];t._byIndex.splice(r+1),t._subject.notify(function(e){e.onInvalidate(r,null)})},this._byKey=Object.create(null),this._subject=new s,e.observe(this)},l=a;$traceurRuntime.createClass(a,{},{},i);var o=a},{"./index":5,"./observable":11}],14:[function(e,t,n){"use strict";Object.defineProperties(n,{ObservableKeyBy:{get:function(){return a}},"default":{get:function(){return o}},__esModule:{value:!0}});var r,u,i=(r=e("./key_by"),r&&r.__esModule&&r||{"default":r})["default"],s=(u=e("./observable"),u&&u.__esModule&&u||{"default":u}).Subject,a=function(e,t){var n=this;$traceurRuntime.superConstructor(l).call(this,e,t),this.observe=function(e){return n._subject.observe(e)},this.onInvalidate=function(e,t){n._subject.notify(function(n){n.onInvalidate(this._keyBySourceKey[e],this._keyBySourceKey[t])})},this._subject=new s,e.observe(this)},l=a;$traceurRuntime.createClass(a,{},{},i);var o=a},{"./key_by":7,"./observable":11}],15:[function(e,t,n){"use strict";Object.defineProperties(n,{ObservableList:{get:function(){return y}},"default":{get:function(){return g}},__esModule:{value:!0}});var r,u,i,s,a,l,o=(r=e("./list"),r&&r.__esModule&&r||{"default":r}).List,c=(u=e("./tree"),u&&u.__esModule&&u||{"default":u}),f=c.Tree,v=c.Path,d=(i=e("./observable"),i&&i.__esModule&&i||{"default":i}).Subject,h=(s=e("./observable_cache"),s&&s.__esModule&&s||{"default":s})["default"],_=(a=e("./observable_index"),a&&a.__esModule&&a||{"default":a})["default"],b=(l=e("./observable_key_by"),l&&l.__esModule&&l||{"default":l})["default"],y=function(e){var t=this;$traceurRuntime.superConstructor(p).call(this,e),this.observe=function(e){throw new Error("Not implemented")},this.reverse=function(){return p.create(p.reverse(t))},this.map=function(e){return p.create(p.map(t,e))},this.filter=function(e){return p.create(p.filter(t,e))},this.flatten=function(){return p.create(p.flatten(t))},this.flatMap=function(e){return p.create(p.flatMap(t,e))},this.cache=function(){return p.create(p.cache(t))},this.index=function(){return p.create(p.index(t))},this.keyBy=function(e){return p.create(p.keyBy(t,e))},this.zip=function(e,n){return p.create(p.zip(t,e,n))},this.skip=function(e){return p.create(p.skip(t,e))},this.take=function(e){return p.create(p.take(t,e))},this.range=function(e,n){return p.create(p.range(t,e,n))},this.scan=function(e,n){return p.create(p.scan(t,e,n))},null!=e&&(this.observe=e.observe)},p=y;$traceurRuntime.createClass(y,{},{isObservableList:function(e){return o.isList(e)&&!!e.observe},create:function(e){return new p({has:e.has,get:e.get,prev:e.prev,next:e.next,observe:e.observe})},reverse:function(e){function t(t){return e.observe({onInvalidate:function(e,n){t.onInvalidate(n,e)}})}var n=o.reverse(e),r=n.has,u=n.get,i=n.prev,s=n.next;return{has:r,get:u,prev:i,next:s,observe:t}},map:function(e,t){var n=o.map(e,t),r=n.has,u=n.get,i=n.prev,s=n.next;return{has:r,get:u,prev:i,next:s,observe:e.observe}},filter:function(e,t){function n(t){return e.observe({onInvalidate:function(e,n){e=u(e)?e:s(e),n=u(n)?n:a(n),t.onInvalidate(e,n)}})}var r=o.filter(e,t),u=r.has,i=r.get,s=r.prev,a=r.next;return{has:u,get:i,prev:s,next:a,observe:n}},flatten:function(e){var t,n=Object.create(null),r=new d;e.observe({onInvalidate:function(e,r){var u;for(u=e;null!=(u=t.next(u))&&u!=r;){var i=n[u];i&&(i.unsubscribe(),delete n[u])}for(u=r;null!=(u=t.prev(u))&&u!=e;){var i=n[u];i&&(i.unsubscribe(),delete n[u])}}}),t=p.cache(p.map(e,function(t,u){return n[u]=t.observe({onInvalidate:function(t,n){var i,s,a=v.append(u,t),l=v.append(u,n);null==t&&(a=f.prev(e,f.next(e,a))),null==n&&(l=f.next(e,f.prev(e,l))),i=v.key(a),s=v.key(l),r.notify(function(e){e.onInvalidate(i,s)})}}),t})),t.observe({onInvalidate:function(t,n){var u=v.key(f.prev(e,[t])),i=v.key(f.next(e,[n]));r.notify(function(e){e.onInvalidate(u,i)})}});var u=o.flatten(t),i=u.has,s=u.get,a=u.next,l=u.prev;return{has:i,get:s,next:a,prev:l,observe:r.observe}},flatMap:function(e,t){return p.flatten(p.map(e,t))},cache:function(e){return new h(e)},index:function(e){return new _(e)},keyBy:function(e,t){return new b(e,t)},zip:function(e,t,n){function r(n){return e.has(n)&&t.has(n)}function u(u){return r(u)?n(e.get(u),t.get(u)):void 0}function i(n){var r=e.prev(n);return null!=r&&r==t.prev(n)?r:null}function s(n){var r=e.next(n);return null!=r&&r==t.next(n)?r:null}e=p.index(e),t=p.index(t);var a=new d,l={onInvalidate:function(e,t){a.notify(function(n){n.onInvalidate(e,t)})}};return e.observe(l),t.observe(l),{has:r,get:u,prev:i,next:s,observe:a.observe}},skip:function(e,t){return p.filter(p.index(e),function(e,n){return n>=t})},take:function(e,t){return p.filter(p.index(e),function(e,n){return t>n})},range:function(e,t,n){return p.filter(p.index(e),function(e,r){return r>=t&&n+t>r})},scan:function(e,t,n){function r(r){var u=i.prev(r);return t(null!=u?i.get(u):n,e.get(r))}function u(t){return e.observe({onInvalidate:function(e,n){t.onInvalidate(e,null)}})}var i,s=e,a=s.has,l=s.prev,o=s.next;return i=p.cache({has:a,get:r,prev:l,next:o,observe:u})}},o);var g=y},{"./list":9,"./observable":11,"./observable_cache":12,"./observable_index":13,"./observable_key_by":14,"./tree":16}],16:[function(e,t,n){"use strict";Object.defineProperties(n,{Path:{get:function(){return u}},Tree:{get:function(){return s}},"default":{get:function(){return a}},__esModule:{value:!0}});var r,u,i=(r=e("./list"),r&&r.__esModule&&r||{"default":r}).List;!function(e){function t(e){return JSON.stringify(e)}function n(e){return null==e?null:JSON.parse(e.toString())}function r(e){return e?e[0]:null}function u(e,t){return e[t]}function i(e){return null==e?[]:e.slice(1,e.length)}function s(e,t){return[].concat(e).concat(t)}e.key=t,e.create=n,e.head=r,e.get=u,e.tail=i,e.append=s}(u||(u={}));var s;!function(e){function t(t,n){var r=void 0!==arguments[2]?arguments[2]:1/0,i=u.head(n),s=u.tail(n);return t.has(i)&&(0==s.length||0==r||e.has(t.get(i),s,r))}function n(t,n){var r=void 0!==arguments[2]?arguments[2]:1/0,i=u.head(n),s=u.tail(n);if(t.has(i)){var a=t.get(i);return 0==s.length||0==r?a:e.get(a,s,r)}}function r(t){var n,r=void 0!==arguments[1]?arguments[1]:[],s=void 0!==arguments[2]?arguments[2]:1/0,a=u.head(r),l=u.tail(r),o=a;if(null==a||t.has(a))do if(n=t.get(o),i.isList(n)&&0!=s){var c=e.prev(n,l,s-1);if(null!=c)return u.append(o,c);l=[]}else if(null!=o&&o!=a)return[o];while(null!=(o=t.prev(o)))}function s(t){var n,r=void 0!==arguments[1]?arguments[1]:[],s=void 0!==arguments[2]?arguments[2]:1/0,a=u.head(r),l=u.tail(r),o=a;if(null==a||t.has(a))do if(n=t.get(o),i.isList(n)&&0!=s){var c=e.next(n,l,s-1);if(null!=c)return u.append(o,c);l=[]}else if(null!=o&&o!=a)return[o];while(null!=(o=t.next(o)))}e.has=t,e.get=n,e.prev=r,e.next=s}(s||(s={}));var a=s},{"./list":9}],17:[function(e,t,n){"use strict";Object.defineProperties(n,{"default":{get:function(){return f}},__esModule:{value:!0}});var r,u,i,s=(r=e("./key"),r&&r.__esModule&&r||{"default":r})["default"],a=(u=e("./observable"),u&&u.__esModule&&u||{"default":u}).Subject,l=(i=e("./mutable_list"),i&&i.__esModule&&i||{"default":i}).MutableList,o=function(e){var t=this;$traceurRuntime.superConstructor(c).call(this),this.has=function(e){return t._key==e},this.get=function(e){return t.has(e)?t._value:void 0},this.prev=function(e){return null==e?t._key:null},this.next=function(e){return null==e?t._key:null},this.set=function(e,n){t._key=e,t._value=n,t._invalidate()},this.splice=function(e,n){for(var r=[],u=2;u<arguments.length;u++)r[u-2]=arguments[u];return r.length?t.set(s.create(),r[0]):(delete t._key,delete t._value,void t._invalidate())},this.observe=function(e){return t._subject.observe(e)},this._invalidate=function(e,n){t._subject.notify(function(t){t.onInvalidate(e,n)})},this._subject=new a,arguments.length&&this.splice(null,null,e)},c=o;$traceurRuntime.createClass(o,{},{},l);var f=o},{"./key":6,"./mutable_list":10,"./observable":11}],18:[function(e,t,n){"use strict";function r(e){return v(e)}Object.defineProperties(n,{"default":{get:function(){return x}},__esModule:{value:!0}});var u,i,s,a,l,o,c,f,r,v=(u=e("./factory"),u&&u.__esModule&&u||{"default":u})["default"],d=(i=e("./list"),i&&i.__esModule&&i||{"default":i})["default"],h=(s=e("./observable_list"),s&&s.__esModule&&s||{"default":s})["default"],_=(a=e("./mutable_list"),a&&a.__esModule&&a||{"default":a})["default"],b=(l=e("./unit"),l&&l.__esModule&&l||{"default":l})["default"],y=(o=e("./array_list"),o&&o.__esModule&&o||{"default":o})["default"],p=(c=e("./linked_list"),c&&c.__esModule&&c||{"default":c})["default"],g=(f=e("./tree"),f&&f.__esModule&&f||{"default":f})["default"];!function(e){function t(t){var n=new e.Unit;return t.then(function(e){n.push(e)}),e.ObservableList.create(n)}function n(e){}e.List=d,e.ObservableList=h,e.MutableList=_,e.Unit=b,e.ArrayList=y,e.LinkedList=p,e.Tree=g,e.fromPromise=t,e.fromIterator=n}(r||(r={}));var x=r},{"./array_list":1,"./factory":4,"./linked_list":8,"./list":9,"./mutable_list":10,"./observable_list":15,"./tree":16,"./unit":17}]},{},[18])(18)});