!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,e.Sonic=t()}}(function(){return function t(e,n,r){function i(u,a){if(!n[u]){if(!e[u]){var s="function"==typeof require&&require;if(!a&&s)return s(u,!0);if(o)return o(u,!0);var l=new Error("Cannot find module '"+u+"'");throw l.code="MODULE_NOT_FOUND",l}var f=n[u]={exports:{}};e[u][0].call(f.exports,function(t){var n=e[u][1][t];return i(n?n:t)},f,f.exports,t,e,n,r)}return n[u].exports}for(var o="function"==typeof require&&require,u=0;u<r.length;u++)i(r[u]);return i}({1:[function(t,e,n){var r=this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);n.prototype=e.prototype,t.prototype=new n},i=t("./observable"),o=t("./mutable_list"),u=function(t){function e(e){var n=this;void 0===e&&(e=[]),t.call(this),this._array=e,new i["default"](function(t){n._invalidate=function(e,n){t(function(t){t.onInvalidate(e,n)})}})}return r(e,t),e.prototype.has=function(t){return t>-1&&t<this._array.length},e.prototype.get=function(t){return this.has(t)?this._array[t]:void 0},e.prototype.prev=function(t){return null==t&&this._array.length?this._array.length-1:this._array.length>0&&null!=t&&this.has(t)&&this.has(t-1)?t-1:null},e.prototype.next=function(t){return null==t&&this._array.length?0:this._array.length>0&&null!=t&&this.has(t)&&this.has(t+1)?t+1:null},e.prototype.set=function(t,e){return this.has(t)?void(this._array[t]=e):!1},e.prototype.splice=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(null==t)t=-1;else if(!this.has(t))return!1;if(null==e)e=this._array.length;else if(!this.has(e))return!1;return(i=this._array).splice.apply(i,[t+1,e-t-1].concat(n)),this._invalidate(t,null),!0;var i},e}(o["default"]);n.ArrayList=u,n["default"]=u},{"./mutable_list":6,"./observable":7}],2:[function(t,e,n){function r(t){return u.MutableList.isMutableList(t)?u.MutableList.create(t):o.ObservableList.isObservableList(t)?o.ObservableList.create(t):i.List.isList(t)?i.List.create(t):Array.isArray(t)?new s["default"](t):a["default"].create(t)}var i=t("./list"),o=t("./observable_list"),u=t("./mutable_list"),a=t("./unit"),s=t("./array_list");n["default"]=r},{"./array_list":1,"./list":5,"./mutable_list":6,"./observable_list":8,"./unit":10}],3:[function(t,e,n){var r;!function(t){function e(t){return t.toString()}function n(t,e){return t instanceof Array?t[e]:0==e?t:void 0}function r(t){return n(t,0)}function i(t){return t instanceof Array?t.slice(1,t.length):[]}function o(t,e){return[].concat(t).concat(e)}t.key=e,t.get=n,t.head=r,t.tail=i,t.append=o}(r=n.Id||(n.Id={})),n["default"]=r},{}],4:[function(t,e,n){var r=this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);n.prototype=e.prototype,t.prototype=new n},i=t("./unique_id"),o=t("./observable"),u=t("./mutable_list"),a=function(t){function e(e){var n=this;t.call(this),this._byId=Object.create(null),this._prev=Object.create(null),this._next=Object.create(null),this._prev[-1]=-1,this._next[-1]=-1,this.splice.apply(this,[null,null].concat(e)),new o["default"](function(t){n._invalidate=function(e,n){t(function(t){t.onInvalidate(e,n)})}})}return r(e,t),e.prototype.has=function(t){return t in this._byId},e.prototype.get=function(t){return this._byId[t]},e.prototype.prev=function(t){return void 0===t&&(t=-1),this._prev[t]},e.prototype.next=function(t){return void 0===t&&(t=-1),this._next[t]},e.prototype.set=function(t,e){return this.has(t)?(this._byId[t]=e,this._invalidate(this._prev[t],this._next[t]),!0):!1},e.prototype.splice=function(t,e){void 0===t&&(t=-1),void 0===e&&(e=-1);for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];for(var o,u,a,s;(o=this._next[o||t])&&(delete this._next[this._prev[o]],delete this._next[u],o!=e);)delete this._byId[o];for(;(u=this._prev[u||e])&&(delete this._prev[this._next[u]],delete this._prev[u],u!=t);)delete this._byId[o];for(var l=0;l<n.length;l++)a=n[l],s=i["default"](),this._byId[s]=a,this._prev[s]=t,this._next[t]=s,t=s;return this._prev[e]=t,this._next[t]=e,this._invalidate(t,e),!0},e}(u["default"]);n["default"]=a},{"./mutable_list":6,"./observable":7,"./unique_id":9}],5:[function(t,e,n){var r=t("./id"),i=function(){function t(t){null!=t&&(this.has=t.has,this.get=t.get,this.prev=t.prev,this.next=t.prev)}return t.prototype.has=function(t){throw new Error("Not implemented")},t.prototype.get=function(t){throw new Error("Not implemented")},t.prototype.prev=function(t){throw new Error("Not implemented")},t.prototype.next=function(t){throw new Error("Not implemented")},t.prototype.first=function(){return t.first(this)},t.prototype.last=function(){return t.last(this)},t.prototype.forEach=function(e){return t.forEach(this,e)},t.prototype.reduce=function(e,n){return t.reduce(this,e)},t.prototype.toArray=function(){return t.toArray(this)},t.prototype.findId=function(e){return t.findId(this,e)},t.prototype.find=function(e){return t.find(this,e)},t.prototype.idOf=function(e){return t.idOf(this,e)},t.prototype.indexOf=function(e){return t.indexOf(this,e)},t.prototype.idAt=function(e){return t.idAt(this,e)},t.prototype.at=function(e){return t.at(this,e)},t.prototype.every=function(e){return t.every(this,e)},t.prototype.some=function(e){return t.some(this,e)},t.prototype.contains=function(e){return t.contains(this,e)},t.prototype.reverse=function(){return t.create(t.reverse(this))},t.prototype.map=function(e){return t.create(t.map(this,e))},t.prototype.filter=function(e){return t.create(t.filter(this,e))},t.prototype.flatten=function(){return t.create(t.flatten(this))},t.prototype.flatMap=function(e){return t.create(t.flatMap(this,e))},t.prototype.cache=function(){return t.create(t.cache(this))},t.isList=function(t){return!!(null!=t&&t.has&&t.get&&t.prev&&t.next)},t.create=function(e){return new t({has:e.has.bind(e),get:e.get.bind(e),prev:e.prev.bind(e),next:e.next.bind(e)})},t.has=function(e,n,i){void 0===i&&(i=1/0);var o=r["default"].head(n),u=r["default"].tail(n);return e.has(o)&&(0==u.length||0==i||t.has(e.get(o),u,i))},t.get=function(e,n,i){void 0===i&&(i=1/0);var o=r["default"].head(n),u=r["default"].tail(n);if(e.has(o)){var a=e.get(o);return 0==u.length||0==i?a:t.get(a,u,i)}},t.next=function(t,e,n){void 0===n&&(n=1/0);{var i=r["default"].head(e);r["default"].tail(e)}if(null==i||t.has(i)){if(0==n)return t.next(i);if(null!=i);else{t.next()}}},t.first=function(t){return t.get(t.next())},t.last=function(t){return t.get(t.prev())},t.forEach=function(t,e){for(var n;null!=(n=t.next(n));)e(t.get(n),n)},t.reduce=function(t,e,n){for(var r;null!=(r=t.next(r));)n=e(n,t.get(r),r);return n},t.toArray=function(e){return t.reduce(e,function(t,e){return t.push(e),t},[])},t.findId=function(t,e){for(var n;null!=(n=t.next(n));)if(e(t.get(n),n))return n},t.find=function(e,n){return e.get(t.findId(e,n))},t.idOf=function(e,n){return t.findId(e,function(t){return t===n})},t.indexOf=function(t,e){for(var n,r=0;null!=(n=t.next(n));){if(t.get(n)===e)return r;r++}},t.idAt=function(t,e){for(var n,r=0;null!=(n=t.next(n));)if(r++==e)return n;return null},t.at=function(e,n){return e.get(t.idAt(e,n))},t.every=function(t,e){for(var n;null!=(n=t.next(n));)if(!e(t.get(n),n))return!1;return!0},t.some=function(t,e){for(var n;null!=(n=t.next(n));)if(e(t.get(n),n))return!0;return!1},t.contains=function(e,n){return t.some(e,function(t){return t===n})},t.reverse=function(t){function e(e){return t.next(e)}function n(e){return t.prev(e)}var r=t.has,i=t.get;return{has:r,get:i,prev:e,next:n}},t.map=function(t,e){function n(n){return e(t.get(n),n)}var r=t.has,i=t.prev,o=t.next;return{has:r,get:n,prev:i,next:o}},t.filter=function(t,e){function n(n){return t.has(n)&&e(t.get(n),n)}function r(e){return n(e)?t.get(e):void 0}function i(e){for(var r=e;null!=(r=t.prev(r));)if(n(r))return r;return null}function o(e){for(var r=e;null!=(r=t.next(r));)if(n(r))return r;return null}return{has:n,get:r,prev:i,next:o}},t.flatten=function(e){function n(t){var n=r["default"].head(t),i=r["default"].get(t,1);return e.has(n)&&e.get(n).has(i)}function i(t){var n=r["default"].head(t),i=r["default"].get(t,1);return e.has(n)?e.get(n).get(i):void 0}function o(t){var n=r["default"].head(t),i=r["default"].get(t,1);if(null==n)n=e.prev();else if(!e.has(n))return;for(i=e.get(n).prev(i);null==i;)n=e.prev(n),i=e.get(n).prev();return r["default"].append(n,i)}function u(n){if(null==n)return[].concat(e.next()).concat(t.first(e).next());var r,i=n[0];if(e.has(i)){if(null!=(r=e.get(i).next(n[1])))return[i,r];for(;null!=(i=e.next(i));)if(null!=(r=e.get(i).next()))return[i,r]}return null}return{has:n,get:i,prev:o,next:u}},t.flatMap=function(e,n){return t.flatten(t.map(e,n))},t.cache=function(t){function e(e){return r["default"].key(e)in u||t.has(e)}function n(e){var n=r["default"].key(e);return n in u?u[n]:t.has(e)?u[n]=t.get(e):void 0}function i(e){if(null==e)return t.prev();var n=r["default"].key(e);return n in a?a[n]:a[n]=t.prev(e)}function o(e){if(null==e)return t.prev();var n=r["default"].key(e);return n in a?a[n]:a[n]=t.prev(e)}var u=Object.create(null),a=(Object.create(null),Object.create(null));return{has:e,get:n,prev:i,next:o}},t}();n.List=i,n["default"]=i},{"./id":3}],6:[function(t,e,n){var r=this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);n.prototype=e.prototype,t.prototype=new n},i=t("./observable_list"),o=function(t){function e(e){t.call(this,e),null!=e&&(this.has=e.has,this.get=e.get,this.prev=e.prev,this.next=e.next,this.observe=e.observe,this.set=e.set,this.splice=e.splice)}return r(e,t),e.prototype.set=function(t,e){throw new Error("Not implemented")},e.prototype.splice=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];throw new Error("Not implemented")},e.prototype.push=function(t){return e.push(this,t)},e.prototype.unshift=function(t){return e.unshift(this,t)},e.prototype.pop=function(){return e.pop(this)},e.prototype.shift=function(){return e.shift(this)},e.prototype["delete"]=function(t){return e["delete"](this,t)},e.prototype.remove=function(t){return e.remove(this,t)},e.isMutableList=function(t){return i.ObservableList.isObservableList(t)&&!!t.set&&!!t.splice},e.create=function(t){return new e({has:t.has.bind(t),get:t.get.bind(t),prev:t.prev.bind(t),next:t.next.bind(t),observe:t.observe.bind(t),set:t.set.bind(t),splice:t.splice.bind(t)})},e.push=function(t,e){return t.splice(t.prev(),null,e),t.prev()},e.unshift=function(t,e){return t.splice(t.next(),null,e),t.next()},e.pop=function(t){var e=t.get(t.prev());return t.splice(t.prev(t.prev()),null),e},e.shift=function(t){var e=t.get(t.next());return t.splice(t.next(t.next()),null),e},e["delete"]=function(t,e){return t.has(e)?t.splice(t.prev(e),t.next(e)):!1},e.remove=function(t,n){var r=e.idOf(t,n);return delete r},e}(i.ObservableList);n.MutableList=o,n["default"]=o},{"./observable_list":8}],7:[function(t,e,n){var r=t("./unique_id"),i=function(){function t(t){var e=this;this.observe=function(t){var n=r["default"](),i=e._observers;return i[n]=t,{unsubscribe:function(){delete i[n]}}},"function"==typeof t&&t(this._notify),this._observers=Object.create(null)}return t.prototype._notify=function(t){for(var e in this._observers)t(this._observers[e])},t}();n.Observable=i,n["default"]=i},{"./unique_id":9}],8:[function(t,e,n){var r=this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);n.prototype=e.prototype,t.prototype=new n},i=t("./list"),o=t("./observable"),u=function(t){function e(e){t.call(this,e),null!=e&&(this.observe=e.observe)}return r(e,t),e.prototype.observe=function(t){throw new Error("Not implemented")},e.isObservableList=function(t){return i.List.isList(t)&&!!t.observe},e.create=function(t){return new e({has:t.has.bind(t),get:t.get.bind(t),prev:t.prev.bind(t),next:t.next.bind(t),observe:t.observe.bind(t)})},e.reverse=function(t){function n(e){return t.observe(e)}var r=i.List.reverse(t),o=r.has,u=r.get,a=r.prev,s=r.next;return e.create({has:o,get:u,prev:a,next:s,observe:n})},e.map=function(t,n){function r(e){return n(t.get(e),e)}var i=t.has,o=t.prev,u=t.next,a=t.observe;return e.create({has:i,get:r,prev:o,next:u,observe:a})},e.filter=function(t,n){function r(e){return t.observe({onInvalidate:function(t,n){t=u(t)?t:s(t),n=u(n)?n:l(n),e.onInvalidate(t,n)}})}var o=i.List.filter(t,n),u=o.has,a=o.get,s=o.prev,l=o.next;return e.create({has:u,get:a,prev:s,next:l,observe:r})},e.flatten=function(t){var n,r,u=Object.create(null),a=new o.Observable(function(t){r=t});t.observe({onInvalidate:function(t,e){var r;for(r=t;null!=(r=n.next(r))&&r!=e;){var i=u[r.toString()];i&&(i.unsubscribe(),delete u[r.toString()])}for(r=e;null!=(r=n.prev(r))&&r!=t;){var i=u[r.toString()];i&&(i.unsubscribe(),delete u[r.toString()])}}}),n=e.cache(e.map(t,function(t,e){return u[e.toString()]=t.observe({onInvalidate:function(t,n){r(function(r){var i=[].concat(e).concat(t),o=[].concat(e).concat(n);r.onInvalidate(i,o)})}}),t})),n.observe({onInvalidate:function(t,e){var i=n.get(t).prev(),o=n.get(e).next();r(function(n){var r=[].concat(t).concat(i),u=[].concat(e).concat(o);n.onInvalidate(r,u)})}});var s=i.List.flatten(n),l=s.has,f=s.get,c=s.next,p=s.prev;return{has:l,get:f,next:c,prev:p,observe:a.observe}},e.cache=function(t){function e(e){return null==e?!1:e.toString()in o||t.has(e)}function n(e){if(null==e)return void 0;var n=e.toString();return n in o?o[n]:t.has(e)?o[n]=t.get(e):void 0}function r(e){if(null==e)return t.prev();var n=e.toString();if(n in a)return a[n];if(null!=t.prev(e)){var r=a[n]=t.prev(e);return u[r.toString()]=e,r}}function i(e){if(null==e)return t.next();var n=e.toString();if(n in u)return u[n];if(null!=t.next(e)){var r=u[n]=t.next(e);return a[r.toString()]=e,r}}var o=Object.create(null),u=Object.create(null),a=Object.create(null);return t.observe({onInvalidate:function(t,e){for(var n=t,r=e;null!=n&&(n=u[n.toString()])&&(delete u[a[n.toString()]],delete a[n.toString()],null==e||n.toString()!=e.toString());)delete o[n.toString()];for(;null!=r&&(r=a[r.toString()])&&(delete a[u[r.toString()]],delete u[r.toString()],null==t||r.toString()!=t.toString());)delete o[r.toString()]}}),{has:e,get:n,prev:r,next:i,observe:t.observe}},e}(i.List);n.ObservableList=u,n["default"]=u},{"./list":5,"./observable":7}],9:[function(t,e,n){function r(){return++i}var i=0;n.uniqueId=r,n["default"]=r},{}],10:[function(t,e,n){var r=this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);n.prototype=e.prototype,t.prototype=new n},i=t("./unique_id"),o=t("./observable"),u=t("./mutable_list"),a=function(t){function e(e){var n=this;t.call(this),arguments.length>2&&this.splice(null,null,e),new o["default"](function(t){n._invalidate=function(e,n){t(function(t){t.onInvalidate(e,n)})}})}return r(e,t),e.prototype.has=function(t){return this._id==t},e.prototype.get=function(t){return this.has(t)?this._value:void 0},e.prototype.prev=function(t){return null==t?this._id:null},e.prototype.next=function(t){return null==t?this._id:null},e.prototype.set=function(t,e){return this._id=t,this._value=e,this._invalidate(),!0},e.prototype.splice=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return n.length?this.set(i["default"](),n[0]):(delete this._id,delete this._value,this._invalidate(),!0)},e}(u["default"]);n["default"]=a},{"./mutable_list":6,"./observable":7,"./unique_id":9}],11:[function(t,e,n){function r(t){return i["default"](t)}var i=t("./factory"),o=t("./list"),u=t("./observable_list"),a=t("./mutable_list"),s=t("./unit"),l=t("./array_list"),f=t("./linked_list");r.List=o["default"],r.ObservableList=u["default"],r.MutableList=a["default"],r.Unit=s["default"],r.ArrayList=l["default"],r.LinkedList=f["default"],e.exports=r},{"./array_list":1,"./factory":2,"./linked_list":4,"./list":5,"./mutable_list":6,"./observable_list":8,"./unit":10}]},{},[11])(11)});